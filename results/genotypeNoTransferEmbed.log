Initalizing Bilstm Host Model--------------------------------
9
DEBUG: Loading checkpoint model!
Model: "model"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 input_1 (InputLayer)           [(None, 1784)]       0           []                               
                                                                                                  
 input_2 (InputLayer)           [(None, 1784)]       0           []                               
                                                                                                  
 embedding (Embedding)          (None, 1784, 20)     560         ['input_1[0][0]',                
                                                                  'input_2[0][0]']                
                                                                                                  
 lstm (LSTM)                    (None, 1784, 512)    1091584     ['embedding[0][0]',              
                                                                  'embedding[1][0]']              
                                                                                                  
 lstm_1 (LSTM)                  (None, 512)          2099200     ['lstm[0][0]',                   
                                                                  'lstm[1][0]']                   
                                                                                                  
 embed_layer (Concatenate)      (None, 1024)         0           ['lstm_1[0][0]',                 
                                                                  'lstm_1[1][0]']                 
                                                                                                  
 dense (Dense)                  (None, 512)          524800      ['embed_layer[0][0]']            
                                                                                                  
 dense_1 (Dense)                (None, 256)          131328      ['dense[0][0]']                  
                                                                                                  
 dense_2 (Dense)                (None, 128)          32896       ['dense_1[0][0]']                
                                                                                                  
 dense_3 (Dense)                (None, 64)           8256        ['dense_2[0][0]']                
                                                                                                  
 dense_4 (Dense)                (None, 9)            585         ['dense_3[0][0]']                
                                                                                                  
==================================================================================================
Total params: 3,889,209
Trainable params: 3,889,209
Non-trainable params: 0
__________________________________________________________________________________________________
DEBUG: Testing embedding
       Accession Protein  ...                                                  X  y
2658  AXB26867.1    ORF3  ...  [26, 13, 3, 12, 6, 3, 17, 24, 22, 3, 3, 19, 18...  0
1640  UHL61947.1    ORF2  ...  [26, 13, 17, 15, 17, 1, 21, 12, 12, 12, 12, 12...  4
1790  AZQ26952.1    ORF2  ...  [26, 13, 17, 15, 17, 1, 21, 12, 12, 12, 24, 6,...  3
1076  BBA80371.1    ORF2  ...  [26, 13, 17, 15, 17, 15, 9, 12, 12, 12, 12, 12...  1
1861  QSD99302.1    ORF2  ...  [26, 13, 17, 15, 17, 1, 21, 12, 12, 12, 6, 6, ...  3
...          ...     ...  ...                                                ... ..
582   BBF24289.1    ORF1  ...  [26, 13, 5, 1, 8, 16, 6, 9, 11, 1, 15, 7, 21, ...  5
2281  QBG59332.1    ORF3  ...  [26, 13, 14, 14, 13, 12, 3, 1, 18, 15, 13, 7, ...  3
1943  BBF24273.1    ORF3  ...  [26, 13, 5, 13, 15, 15, 3, 1, 12, 7, 12, 6, 3,...  5
1291  BAM68894.1    ORF2  ...  [26, 13, 17, 15, 7, 1, 9, 12, 12, 12, 12, 21, ...  4
2126  QWN59211.1    ORF3  ...  [26, 13, 3, 1, 5, 3, 21, 18, 12, 18, 3, 18, 3,...  0

[1424 rows x 7 columns]
[array([[ 0,  0,  0, ..., 24, 16, 13],
       [ 0,  0,  0, ..., 17,  5, 18],
       [ 0,  0,  0, ..., 17,  5, 18],
       ...,
       [ 0,  0,  0, ..., 12, 17, 17],
       [ 0,  0,  0, ..., 17,  5, 18],
       [ 0,  0,  0, ..., 18, 17, 16]], dtype=int8), array([[ 0,  0,  0, ...,  3, 13, 26],
       [ 0,  0,  0, ..., 17, 13, 26],
       [ 0,  0,  0, ..., 17, 13, 26],
       ...,
       [ 0,  0,  0, ...,  5, 13, 26],
       [ 0,  0,  0, ..., 17, 13, 26],
       [ 0,  0,  0, ...,  3, 13, 26]], dtype=int8)]

 1/10 [==>...........................] - ETA: 56s
 2/10 [=====>........................] - ETA: 51s
 3/10 [========>.....................] - ETA: 44s
 4/10 [===========>..................] - ETA: 38s
 5/10 [==============>...............] - ETA: 32s
 6/10 [=================>............] - ETA: 25s
 7/10 [====================>.........] - ETA: 19s
 8/10 [=======================>......] - ETA: 12s
 9/10 [==========================>...] - ETA: 6s 
10/10 [==============================] - ETA: 0s
10/10 [==============================] - 63s 6s/step
------------------- Category: Protein ---------------------
Purity of louvain cluster 0 in category Protein with majority element ORF2: 0.4339080459770115
Purity of louvain cluster 1 in category Protein with majority element ORF3: 0.993485342019544
Purity of louvain cluster 2 in category Protein with majority element ORF2: 0.9869281045751634
Purity of louvain cluster 3 in category Protein with majority element ORF1: 0.9588235294117647
Purity of louvain cluster 4 in category Protein with majority element ORF3: 0.7333333333333333
Purity of louvain cluster 5 in category Protein with majority element ORF1: 0.9300699300699301
------------------- Category: Host ---------------------
Purity of louvain cluster 0 in category Host with majority element Human: 0.6436781609195402
Purity of louvain cluster 1 in category Host with majority element Human: 0.8143322475570033
Purity of louvain cluster 2 in category Host with majority element Human: 0.7679738562091504
Purity of louvain cluster 3 in category Host with majority element Human: 0.7058823529411765
Purity of louvain cluster 4 in category Host with majority element Human: 0.6866666666666666
Purity of louvain cluster 5 in category Host with majority element Human: 0.7692307692307693
------------------- Category: Genotype ---------------------
Purity of louvain cluster 0 in category Genotype with majority element HEV4: 0.41379310344827586
Purity of louvain cluster 1 in category Genotype with majority element HEV3: 0.8957654723127035
Purity of louvain cluster 2 in category Genotype with majority element HEV3: 0.9117647058823529
Purity of louvain cluster 3 in category Genotype with majority element HEV3: 0.8352941176470589
Purity of louvain cluster 4 in category Genotype with majority element HEV4: 0.8533333333333334
Purity of louvain cluster 5 in category Genotype with majority element HEV3: 0.9090909090909091
