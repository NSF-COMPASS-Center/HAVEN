Initalizing Bilstm Host Model--------------------------------
DEBUG: Loaded transfer checkpoint!
Model: "model"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 input_1 (InputLayer)           [(None, 1784)]       0           []                               
                                                                                                  
 input_2 (InputLayer)           [(None, 1784)]       0           []                               
                                                                                                  
 embedding (Embedding)          (None, 1784, 20)     560         ['input_1[0][0]',                
                                                                  'input_2[0][0]']                
                                                                                                  
 lstm (LSTM)                    (None, 1784, 512)    1091584     ['embedding[0][0]',              
                                                                  'embedding[1][0]']              
                                                                                                  
 lstm_1 (LSTM)                  (None, 512)          2099200     ['lstm[0][0]',                   
                                                                  'lstm[1][0]']                   
                                                                                                  
 embed_layer (Concatenate)      (None, 1024)         0           ['lstm_1[0][0]',                 
                                                                  'lstm_1[1][0]']                 
                                                                                                  
 dense (Dense)                  (None, 28)           28700       ['embed_layer[0][0]']            
                                                                                                  
 activation (Activation)        (None, 28)           0           ['dense[0][0]']                  
                                                                                                  
==================================================================================================
Total params: 3,220,044
Trainable params: 3,220,044
Non-trainable params: 0
__________________________________________________________________________________________________
9
DEBUG: Testing embedding
       Accession Protein  ...                                                  X  y
1813  QAB14111.1    ORF2  ...  [26, 13, 3, 1, 17, 1, 21, 12, 12, 12, 6, 12, 1...  8
1132  QAB44030.1    ORF2  ...  [26, 13, 17, 15, 17, 15, 9, 12, 12, 12, 6, 12,...  1
2322  ART85722.1    ORF3  ...  [26, 13, 7, 18, 15, 3, 1, 12, 7, 12, 6, 3, 3, ...  3
605   QCF29662.1    ORF1  ...  [26, 13, 5, 1, 8, 16, 6, 9, 11, 1, 15, 7, 21, ...  5
1073  QSD99359.1    ORF2  ...  [26, 13, 17, 15, 17, 1, 21, 12, 12, 12, 6, 6, ...  3
...          ...     ...  ...                                                ... ..
2763  QSD99091.1    ORF3  ...  [26, 13, 7, 18, 15, 3, 1, 12, 7, 12, 6, 3, 3, ...  3
905   AXF47830.1    ORF1  ...  [26, 13, 5, 1, 8, 16, 6, 9, 11, 1, 15, 7, 9, 1...  3
1096  UBR08179.1    ORF2  ...  [26, 13, 3, 15, 17, 1, 21, 12, 12, 12, 6, 6, 2...  3
235   QSD99363.1    ORF1  ...  [26, 13, 5, 1, 8, 16, 6, 9, 11, 1, 15, 7, 9, 1...  3
1061  QBF12160.1    ORF2  ...  [26, 13, 17, 15, 17, 1, 21, 12, 12, 12, 6, 12,...  3

[2848 rows x 7 columns]
[array([[ 0,  0,  0, ..., 17,  5, 18],
       [ 0,  0,  0, ..., 17,  5, 12],
       [ 0,  0,  0, ..., 12, 17, 17],
       ...,
       [ 0,  0,  0, ..., 17,  5,  6],
       [ 0,  0,  0, ..., 17, 21,  5],
       [ 0,  0,  0, ..., 17,  5, 18]], dtype=int8), array([[ 0,  0,  0, ...,  3, 13, 26],
       [ 0,  0,  0, ..., 17, 13, 26],
       [ 0,  0,  0, ...,  7, 13, 26],
       ...,
       [ 0,  0,  0, ...,  3, 13, 26],
       [ 0,  0,  0, ...,  5, 13, 26],
       [ 0,  0,  0, ..., 17, 13, 26]], dtype=int8)]

 1/22 [>.............................] - ETA: 2:34
 2/22 [=>............................] - ETA: 2:51
 3/22 [===>..........................] - ETA: 2:39
 4/22 [====>.........................] - ETA: 2:30
 5/22 [=====>........................] - ETA: 2:23
 6/22 [=======>......................] - ETA: 2:18
 7/22 [========>.....................] - ETA: 2:10
 8/22 [=========>....................] - ETA: 2:01
 9/22 [===========>..................] - ETA: 1:52
10/22 [============>.................] - ETA: 1:43
11/22 [==============>...............] - ETA: 1:34
12/22 [===============>..............] - ETA: 1:26
13/22 [================>.............] - ETA: 1:17
14/22 [==================>...........] - ETA: 1:09
15/22 [===================>..........] - ETA: 1:00
16/22 [====================>.........] - ETA: 51s 
17/22 [======================>.......] - ETA: 43s
18/22 [=======================>......] - ETA: 34s
19/22 [========================>.....] - ETA: 25s
20/22 [==========================>...] - ETA: 17s
21/22 [===========================>..] - ETA: 8s 
22/22 [==============================] - ETA: 0s
22/22 [==============================] - 186s 8s/step
------------------- Category: Protein ---------------------
Purity of louvain cluster 0 in category Protein with majority element ORF2: 0.9954022988505747
Purity of louvain cluster 1 in category Protein with majority element ORF1: 1.0
Purity of louvain cluster 2 in category Protein with majority element ORF3: 0.9111111111111111
Purity of louvain cluster 3 in category Protein with majority element ORF3: 0.9754098360655737
Purity of louvain cluster 4 in category Protein with majority element ORF1: 0.9581993569131833
Purity of louvain cluster 5 in category Protein with majority element ORF3: 0.8879310344827587
Purity of louvain cluster 6 in category Protein with majority element ORF2: 1.0
Purity of louvain cluster 7 in category Protein with majority element ORF1: 1.0
Purity of louvain cluster 8 in category Protein with majority element ORF2: 1.0
Purity of louvain cluster 9 in category Protein with majority element ORF2: 0.8333333333333334
------------------- Category: Host ---------------------
Purity of louvain cluster 0 in category Host with majority element Human: 0.7264367816091954
Purity of louvain cluster 1 in category Host with majority element Human: 0.7083333333333334
Purity of louvain cluster 2 in category Host with majority element Human: 0.5407407407407407
Purity of louvain cluster 3 in category Host with majority element Human: 0.8989071038251366
Purity of louvain cluster 4 in category Host with majority element Human: 0.7652733118971061
Purity of louvain cluster 5 in category Host with majority element Human: 0.6681034482758621
Purity of louvain cluster 6 in category Host with majority element Human: 0.8258928571428571
Purity of louvain cluster 7 in category Host with majority element Human: 0.7209302325581395
Purity of louvain cluster 8 in category Host with majority element Human: 0.8333333333333334
Purity of louvain cluster 9 in category Host with majority element Human: 0.7592592592592593
------------------- Category: Genotype ---------------------
Purity of louvain cluster 0 in category Genotype with majority element HEV3: 0.8620689655172413
Purity of louvain cluster 1 in category Genotype with majority element HEV3: 0.6620370370370371
Purity of louvain cluster 2 in category Genotype with majority element HEV3: 0.5802469135802469
Purity of louvain cluster 3 in category Genotype with majority element HEV3: 0.9344262295081968
Purity of louvain cluster 4 in category Genotype with majority element HEV3: 0.9196141479099679
Purity of louvain cluster 5 in category Genotype with majority element HEV4: 0.7672413793103449
Purity of louvain cluster 6 in category Genotype with majority element HEV3: 0.8883928571428571
Purity of louvain cluster 7 in category Genotype with majority element HEV4: 0.8418604651162791
Purity of louvain cluster 8 in category Genotype with majority element HEV4: 0.9885057471264368
Purity of louvain cluster 9 in category Genotype with majority element HEV1: 0.8333333333333334
